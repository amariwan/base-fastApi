############################################################
# üåê CORE
############################################################
APP_NAME=service
APP_ENV=local               # local | staging | production
API_PREFIX=/api
LOG_LEVEL=INFO              # DEBUG, INFO, WARNING, ERROR, CRITICAL
TEST_MODE=false
PYTHONPATH=src

############################################################
# üóÑÔ∏è DATABASE CONFIGURATION
############################################################
# DSN bevorzugt ‚Äì √ºberschreibt Einzelwerte:
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5433/database
ALEMBIC_TARGETS="service.models:Base"

# Fallback (wenn kein DSN gesetzt)
DB_HOST=localhost
DB_PORT=5433
DB_USERNAME=postgres
DB_PASSWORD=postgres
DB_DATABASE=database

# Connection Pool
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=5
DB_POOL_RECYCLE_SECS=300
DB_POOL_TIMEOUT=30

# Timeouts (Sekunden)
DB_CONNECT_TIMEOUT=10
DB_COMMAND_TIMEOUT=60

# Startup Retry & Backoff
DB_STARTUP_MAX_RETRIES=10
DB_STARTUP_BASE_DELAY=0.5
DB_STARTUP_MAX_DELAY=10
DB_STARTUP_OVERALL_TIMEOUT=60

# SSL-Optionen
DB_SSL=false
DB_SSL_NO_VERIFY=false

# PostgreSQL interne Session-Timeouts (Millisekunden)
PG_STATEMENT_TIMEOUT_MS=60000
PG_IDLE_IN_XACT_TIMEOUT_MS=300000

############################################################
# üîê AUTHENTICATION & ROLE MANAGEMENT
############################################################
AUTH_MODE=jwks                    # jwks | hs
AUTH_ROLE_PREFIX=GRPS_

# Rollensteuerung
ROLES_ACTIVE=true
ROLES_READ=
ROLES_WRITE=
ROLES_DELETE=
ROLES_ADMIN=Admin
AUTH_MANDANT_CLAIM=organisation

# JWKS / OpenID Provider
AUTH_JWKS_URL=https://example.com/realms/DevRealm/protocol/openid-connect/certs
AUTH_ISSUER=https://example.com/realms/DevRealm
AUTH_AUDIENCE=service
AUTH_ALGORITHMS=RS256

# HMAC (nur wenn AUTH_MODE=hs)
AUTH_HS_SECRET=

# Verification Flags
AUTH_VERIFY_SIGNATURE=true
AUTH_VERIFY_EXP=true
AUTH_VERIFY_ISS=true
AUTH_VERIFY_AUD=true
AUTH_CLOCK_SKEW_SECS=60

# Windows/MSYS Fix
MSYS2_ENV_CONV_EXCL=API_PREFIX

############################################################
# üõ°Ô∏è SECURITY & HTTP CONFIG
############################################################
# CORS
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=*            # Nur f√ºr DEV: In PROD spezifisch setzen!
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*

# Rate Limiting
RATE_LIMIT_ENABLED=false
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60

# Request Limits (Byte)
MAX_REQUEST_SIZE_BYTES=10485760   # 10 MB
MAX_UPLOAD_SIZE_BYTES=52428800    # 50 MB

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=false
CSP_DIRECTIVES="default-src 'self'"

# Optionaler API-Key Schutz
REQUIRE_API_KEY=false
API_KEY_HEADER=X-API-Key
API_KEY=

# HTTP Logging
HTTP_LOGGING_ENABLED=true
HTTP_REQUEST_LOGGING_ENABLED=false
HTTP_RESPONSE_LOGGING_ENABLED=false
HTTP_FAULT_LOGGING_ENABLED=true
